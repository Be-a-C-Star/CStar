## PCB(Process Control Block)

###### 운영체제에서 관리하는 프로세스에 대한 메타 데이터를 저장한 데이터 블록이다. 커널 스택에 저장되며 각 프로세스가 생성될 때마다 고유의 PCB가 생성이 되고 프로세스가 종료되면 PCB는 제거된다.

가상 메모리는 사용자 공간과 커널 공간으로 구분되며 이 두가지의 공간 모두 스택 자료구조를 기반으로 관리된다하여 사용자 스택, 커널 스택이라고도 불린다.

#### 커널 스택(커널 공간)

- 커널 스택은 가상 메모리 주소의 윗부분을 말한다.
- 예를 들어 가장 처음 시작하는 주소값이다라고 보면 된다.
- 이 커널스택은 '커널모드'에서만 접근할 수 있다.

#### 사용자 스택(사용자 공간)

- 사용자 스택은 유저 모드에서만 접근 가능하다.

#### 메타데이터

###### 데이터에 관한 구조화된 데이터이자 데이터를 설명하는 작은 데이터, 대량의 정보 가운데에서 찾고 있는 정보를 효율적으로 찾아내서 이용하기 위해 일정한 규칙에 따라 콘텐츠에 대해 부여되는 데이터이다.

---

### PCB의 구조

중요한 것만 기반으로 살펴보면 다음과 같다.
![alt text](<스크린샷 2025-04-15 오후 1.33.19.png>)

- 프로세스 상태 - 대기중, 실행 중 등 프로세스의 상태
- 프로세스 번호(PID) - 각 프로세스의 고유 식별 번호(프로세스 ID)
- 프로그램 카운터(PC) - 이 프로세스에 대해 실행될 다음 명령의 주소에 대한 포인터
- 레지스터 - 레지스터 관련 정보
- 메모리 제한 - 프로세스의 메모리 관련 정보
- 열린 파일 정보 - 프로세스를 위해 열린 파일 목록들

---

### 컨텍스트 스위칭(Context Switching)

###### PCB를 기반으로 프로세스의 상태를 저장하고 다시 복원시키는 과정이다.(스레드 또한 컨텍스트 스위칭 가능) 프로세스가 종료되거나 인터럽트에 의해 발생된다.

![alt text](<스크린샷 2025-04-15 오후 1.35.21.png>)

#### 컨텍스트 스위칭의 비용

- 유휴시간의 발생
  - 컨텍스트 스위칭을 할 때마다 프로세스 당 유휴시간이 발생한다.
- 캐시미스
  - 프로세스가 가지고 있는 메모리 주소가 그대로 있으면 잘못된 주소 변환이 생기므로 캐시 클리어 과정이 무조건 일어나게되고 이 때문에 캐시 미스가 발생한다.
- 오버헤드
  - CPU는 중단된 작업의 상태(레지스터, 프로그램 카운터, 메모리 매핑 등)를 저장하고, 새 작업의 상태를 로드해야 한다.
  - 이때 일정한 오버헤드가 발생하게 되며 이 오버헤드가 자주 발생하면 전체적으로 시스템 성능이 저하될 수 있으며, CPU의 유효 가동 시간에 영향을 미칠 수 있다.

#### 스레드에서의 컨텍스트 스위칭

- 스레드는 스택 영역을 제외한 모든 메모리를 공유하기 때문에 비용이 더 적고 시간도 더 적게 걸린다는 장점이 있다.
