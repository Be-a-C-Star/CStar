## 1. 인덱스의 구조와 효율적인 이유

- **인덱스란?**
  책의 맨 뒤에 있는 ‘찾아보기’(목차 같은 것)와 같아요. 데이터베이스에서 특정 데이터를 빠르게 찾도록 도와주는 자료구조.

- **대표적인 인덱스 구조: B-트리(Balanced Tree)**
  대부분의 DB는 B-트리 구조를 사용해요. 트리 구조는 계층적이며, 균형이 잘 맞아서 탐색할 때 최악의 경우에도 일정한 깊이에서 데이터를 찾을 수 있다.

  - 루트에서 시작해 왼쪽이나 오른쪽 가지로 내려가며 비교
  - 탐색 속도가 O(log n)으로 빠름
  - 대용량 데이터에서도 효율적

- **효율적인 이유**

  - 전체 데이터를 하나하나 순차 검색하지 않아도 됨
  - 인덱스에 저장된 키 값만 보고 바로 원하는 위치를 찾아감
  - 디스크 I/O를 최소화해서 빠르게 탐색 가능

---

## 2. 인덱스 성능 최적화

- **적절한 컬럼 선택**
  자주 조회하거나 조건절(WHERE)에 많이 사용되는 컬럼에 인덱스를 생성해야 효과적
  (예: 회원 테이블에서 `회원ID`, `이메일` 등)

- **인덱스 크기 줄이기**
  인덱스가 커지면 메모리 캐싱 효율 떨어지고 디스크 I/O 증가

  - 필요한 컬럼만 포함시키기 (특히 복합 인덱스는 꼭 필요한 컬럼만!)
  - 너무 긴 문자열 컬럼은 인덱스에 포함하지 않는 게 좋음

- **인덱스 종류 활용**

  - B-트리 인덱스: 범위 검색, 정렬에 유리
  - 해시 인덱스: 정확한 값 검색에 빠름 (하지만 범위 검색 불가)
  - 비트맵 인덱스: 낮은 카디널리티(값 종류가 적은 컬럼)에 적합

- **쿼리 최적화**
  인덱스를 활용하려면 쿼리도 인덱스 순서, 컬럼 활용에 맞게 작성하는 게 중요

---

## 3. 인덱스 비용

- **저장 공간**
  인덱스는 데이터 외에 별도의 저장 공간을 차지해요. 컬럼 수가 많거나 데이터가 많으면 인덱스도 커져서 저장 비용 증가

- **쓰기 성능 저하**
  데이터 삽입, 수정, 삭제 시 인덱스도 같이 갱신돼야 해서 쓰기 작업이 느려질 수 있음
  → 인덱스 너무 많이 만들면 쓰기 성능 저하 심함

- **관리 비용**
  불필요하거나 사용하지 않는 인덱스가 많으면 DB 관리가 어려워짐

---

## 4. 테스팅 (인덱스 효과 검증)

- **실행 계획 확인**

  - `EXPLAIN` 또는 `EXPLAIN ANALYZE` 같은 명령어로 쿼리 실행 계획을 보고 인덱스가 사용되는지 확인
  - 인덱스 스캔(Index Scan), 시퀀셜 스캔(Sequential Scan) 등 확인 가능

- **쿼리 성능 측정**

  - 인덱스 생성 전후 쿼리 실행 시간 비교
  - 실제 데이터 양과 쿼리 패턴에 따른 테스트가 필요

- **부하 테스트**

  - 쓰기 작업에 미치는 영향도 측정

---

## 5. 복합 인덱스 (Composite Index)

- **복합 인덱스란?**
  둘 이상의 컬럼을 묶어 하나의 인덱스로 만드는 것
  (예: `WHERE (이름, 나이)` 조건을 자주 쓴다면 복합 인덱스 생성)

- **복합 인덱스 사용법 및 특징**

  - 인덱스 순서가 중요 (예: `(이름, 나이)` 인덱스는 `이름`만으로도 사용 가능하지만, `나이`만으로는 사용 안 됨)
  - 조건에 맞게 컬럼 순서를 잘 설계해야 함
  - 복합 인덱스 하나로 여러 컬럼 조건을 커버 가능해 성능 향상

- **커버링 인덱스**
  인덱스 안에 쿼리에 필요한 모든 컬럼이 포함되어 테이블 접근 없이 인덱스만으로 결과를 반환할 수 있는 인덱스

---

### 정리

| 항목        | 설명                                                                 |
| ----------- | -------------------------------------------------------------------- |
| 인덱스 구조 | B-트리가 대표적, 계층형 자료구조로 빠른 탐색 가능                    |
| 성능 최적화 | 자주 쓰는 컬럼에 인덱스, 인덱스 크기 최소화, 적절한 인덱스 종류 활용 |
| 비용        | 저장 공간 증가, 쓰기 작업 성능 저하, 관리 비용 발생                  |
| 테스팅      | 실행 계획(EXPLAIN) 확인, 쿼리 시간 비교, 부하 테스트                 |
| 복합 인덱스 | 두 개 이상 컬럼 묶음, 순서 중요, 여러 조건 커버 가능                 |
