## 문자열: CHAR

CHAR는 테이블을 생성할 때 선언한 길이로 고정되며 길이는 0에서 255 사이의 값, 레코드를 저장할 때 무조건 선언한 길이 값으로 ‘고정’해서 저장됨.

## 문자열: VARCHAR

VARCHAR는 가변 길이 문자열이다. 길이는 0에서 65,535사이의 값. 입력된 데이터에 따라 용량을 가변시켜 저장한다.

예를 들어 아스키 코드를 담는다고 가정하며 varchar(10000)으로 선언해도 데이터의 길이가 10이라면 데이터(10바이트) + 길이기록용(1바이트), 총 11바이트로 용량을 가변하여 저장한다.

참고로 VARCHAR의 최대 길이가 255를 초과하는 경우, 데이터의 길이는 2바이트를 사용하여 저장한다.

즉, 유동적인 데이터는 varchar, 유동적이지 않고 고정적인 데이터는 char로 저장하는게 좋다.

---

## CHAR과 VARCHAR의 데이터 저장 로직 차이

다음과 같이 CHAR은 데이터가 작거나 크거나 상관없이 4바이트씩 저장, VARCHAR는 유동적으로 저장되는 것을 볼 수 있다.

![alt text](<스크린샷 2025-05-28 오후 12.43.34.png>)

---

## VARCHAR 최대 길이로 설정할 때 주의할 점

1. MySQL의 행의 최대 크기는 65,535바이트이다.
2. MySQL가 사용하는 문자인코딩방식은 5.5.3 버전부터 UTF8을 지원하는 `utf8mb4`이다. 이는 4바이트가 필요한 이모지와 3바이트가 필요한 한글을 모두 커버하는 인코딩 방식이다.
3. 괄호안에 들어가는 숫자는 바이트가 아니라 길이제한이다.

#### VARCHAR 생성 예시 코드

##### 생성 불가

```node
CREATE TABLE t3
(c1 VARCHAR(65533) NOT NULL);
```

- 위 코드는 데이터 길이 기록용 2바이트를 제외하고 `VARCHAR(65533)`으로 선언해도 동작하지 않는다.
- 이유는 기본적으로 UTF-8인데, 한글은 3바이트, 이모지는 4바이트가 필요하여 만약 65533개의 문자열이 모두 한글, 이모지로 돼있다면, 65533(문자열의 길이) \* 3byte or 4byte이 필요하게 된다.

##### 생성 가능

```node
CREATE TABLE t4
(c1 VARCHAR(16383) NOT NULL);
```

- 위 코드는 선언할 수 있는 최대 문자열 길이 65533에서 최대 크기 이모지의 하나에 해당하는 4바이트를 나눠서 선언하는 방법이다. 나누면 16383.25가 나오는데 소숫점을 버리고 문자열의 길이 16383으로 선언한다.

##### 생성 가능

```node
CREATE TABLE t2
(c1 VARCHAR(65533) NOT NULL)
ENGINE = InnoDB CHARACTER SET latin1;
```

- 위 코드는 똑같이 길이 65533으로 선언해도 정상적으로 동작한다. 이유는 `ENGINE = InnoDB CHARACTER SET latin1`이 부분을 통해 하나당 1바이트에 해당하는 아스키 코드로 선언하기 때문이다.

##### 생성 불가

```node
CREATE TABLE book3(
  id INT NOT NULL AUTO_INCREMENT,
  title VARCHAR(65533) NOT NULL,
  PRIMARY KEY (id)
) ENGINE = InnoDB CHARACTER SET latin1;
```

- 위 코드를 정상적으로 동작하게 하려면 INT에 해당하는 4바이트를 빼줘야 하기때문에 `VARCHAR(65529)`로 선언해야 된다.
