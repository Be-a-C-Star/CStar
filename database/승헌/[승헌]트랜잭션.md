## **✅ 트랜잭션, 커밋, 롤백, 트랜잭션 전파**

### **트랜잭션(Transaction)**

- 데이터베이스에서 **하나의 논리적인 작업 단위** (쿼리를 묶는 단위)
- **원자성(Atomicity)**을 보장, 전부 성공하거나 전부 실패해야 함
- *e.g.* 계좌 이체 (출금 + 입금)

### **커밋(Commit)**

- 트랜잭션의 **모든 작업을 성공적으로 완료**하고 **DB에 영구 반영**

### **롤백(Rollback)**

- 트랜잭션 도중 오류가 발생했을 때, **이전 상태로 복구**
- 모든 작업을 취소하고 트랜잭션 시작 전 상태로 되돌림

### **트랜잭션 전파(Transaction Propagation)**

- **트랜잭션이 중첩될 때의 처리 방식**
- 스프링에서 자주 사용하는 개념
- *e.g.* 부모 트랜잭션이 존재할 때, 자식 트랜잭션이 새로 시작할지, 기존에 참여할지 결정함

## **✅ ACID**

트랜잭션이 만족해야 할 4가지 성질

1. **Atomicity (원자성)**
    - 트랜잭션 내 작업은 **모두 성공하거나 모두 실패**해야 함
2. **Consistency (일관성)**
    - 트랜잭션 완료 후, **데이터는 일관성 있는 상태**로 유지되어야 함
3. **Isolation (격리성)**
    - 동시에 실행되는 트랜잭션이 **서로 영향을 미치지 않아야 함**
4. **Durability (지속성)**
    - 커밋된 트랜잭션의 결과는 **영구히 보존**되어야 함 (전원 꺼져도 유지)

## **✅ 격리성 (Isolation)**

- 동시에 여러 트랜잭션이 실행될 때 **서로 간섭 없이 실행**되도록 보장하는 성질
- 격리성이 낮으면 성능은 좋지만, 여러 문제들이 발생할 수 있음
- 동시성과 반비례

## **✅ 격리 수준에 따른 현상**

### **팬텀 리드(Phantom Read)**

- **같은 조건의 쿼리를 두 번 실행했을 때 결과 행 수가 달라짐**
- 중간에 다른 트랜잭션이 데이터를 삽입 또는 삭제함

### **더티 리드(Dirty Read)**

- **커밋되지 않은 데이터**를 다른 트랜잭션이 읽는 현상
    
    → 롤백 시 읽은 데이터는 잘못된 데이터가 됨
    

### **반복 불가능한 읽기(Non-Repeatable Read)**

- **같은 데이터를 두 번 읽었는데 값이 다름**
- 중간에 다른 트랜잭션이 데이터를 변경했기 때문

## **✅ 격리 수준 (Isolation Level)**

| **수준** | **더티 리드** | **반복 불가능한 읽기** | **팬텀 리드** |
| --- | --- | --- | --- |
| **Read Uncommitted** | 발생함 | 발생함 | 발생함 |
| **Read Committed** | 방지됨 | 발생함 | 발생함 |
| **Repeatable Read** | 방지됨 | 방지됨 | 발생함 |
| **Serializable** | 방지됨 | 방지됨 | 방지됨 |

### **Read Uncommitted**

- 가장 낮은 수준
- **다른 트랜잭션의 커밋되지 않은 변경사항도 읽을 수 있음**
- 성능은 좋지만 **데이터 신뢰성은 최악**

### **Read Committed**

- 오라클 기본 수준
- **커밋된 데이터만 읽음**
- 더티 리드는 방지하지만, **반복 불가능한 읽기 발생 가능**

### **Repeatable Read**

- MySQL InnoDB 기본 수준
- **트랜잭션 동안 읽은 데이터는 계속 동일**
- 팬텀 리드는 방지 못함

### **Serializable**

- 가장 높은 수준
- 트랜잭션 간 **직렬화**되어 동작
- 완벽한 격리 보장, 하지만 **성능 저하**