### 세션 기반 인증

##### 로그인을 했을 때 로그인 상태를 어떻게 유지할까?

- 로그인을 유지하려면 이전에 로그인한 상태값이 남아있어야 함
- 세션 기반 인증 방식은 이러한 로그인 상태를 세션을 통해서 유지함

##### 세션

###### 서버와 클라이언트의 연결이 활성화된 상태

##### 세션ID

###### 웹 서버 또는 DB에 저장되는 클라이언트에 대한 유니크한 ID

##### 세션기반 로그인 프로세스

1. 최초 로그인 - 세션ID가 생성 - 서버에서 세션ID를 쿠키로 설정해서 클라이언트에 전달
   ![alt text](<스크린샷 2025-02-04 오후 2.07.28.png>)

2. 클라이언트가 서버에 요청을 보낼 때 해당 세션ID를 쿠키로 담아서 전에 로그인했던 아이디인지 확인
   ![alt text](<스크린샷 2025-02-04 오후 2.09.41.png>)

3. 로그인을 유지(로그인이 안 된 유저는 유저 아이디가 NULL임)
   ![alt text](<스크린샷 2025-02-04 오후 2.11.56.png>)

<br>

##### 전체 과정

![alt text](<스크린샷 2025-02-04 오후 2.21.42.png>)

- 구현에 따라 방문자가 처음 리퀘스트를 보냈을 때 세션 데이터를 만들어 아이디를 클라이언트에 전달하거나, 방문자가 유저로서 로그인 했을 때 보내도 됨

---

#### 단점

- 사용자의 상태에 관한 데이터를 서버에 저장했을 때 로그인 중인 유저의 수가 늘어난다면 서버의 메모리 과부화가 일어날 수 있음
- DB 중 RDBMS에 저장한다면 직렬화 및 역직렬화에 관한 오버헤드가 발생함
- RESTful API: REST에 부합하기 위해서는 서버가 상태 정보를 저장하지 않는, stateless 한 특성이 있어야 하는데, 세션 기반 인증 방식은 서버에서 세션 정보를 저장하고 있어야하기 때문에 RESTful한 API 서버에는 적합하지 않음
- 세션 ID가 탈취되면 공격자가 피해자의 계정으로 로그인할 수 있음
  - 해결 방법으로 HTTPS 사용, Secure & HttpOnly 쿠키 설정, 세션 타임아웃 설정 등이 있음.

---

#### 사용 예시

- 사용자가 적거나, 서버의 상태를 유지해도 부담이 없는 경우
- 하나의 도메인(Origin)에서만 인증이 필요한 경우
- 쇼핑몰 웹사이트(장바구니 기능, 주문 내역 조회 등)
- 사내 인트라넷 시스템
  - 내부 직원들만 사용하는 시스템(인사 관리 시스템 등)
  - 사용자가 많지 않고, 보안이 중요하므로 서버에서 직접 세션을 관리하는 게 유리함
  - 모든 요청에서 세션 ID를 쿠키로 자동 전송하여 로그인 상태를 유지할 수 있음.
