## HTTP의 멱등성(Idempotent)

###### HTTP 멱등성이란 하나의 요청이 아닌 여러번 동일한 요청을 보냈을 때 서버가 같은 상태를 가지는 것

### 멱등성을 가지는 메서드

멱등성을 가지는 메서드는 GET, HEAD, OPTIONS, PUT, DELETE가 있다.
그 중 GET, HEAD, OPTIONS는 안전한 메서드라고도 한다.

#### GET

- 이 메서드는 서버에서 정보를 가져오는 데 사용된다. 여러 개의 동일한 GET 요청을 하는 것은 한 번의 요청을 하는 것과 같은 효과를 가진다.(안전한 메서드)

#### HEAD

- 이 메서드는 GET 요청이 생성하는 응답의 헤더를 검색하는 데 사용된다.
- 보통 리소스 전체를 다운로드하는 오버헤드를 피하고 어떤 유형의 데이터가 반환되는지, 해당 리소스가 있는지, 수정날짜 등을 확인하기 위해 쓰인다.
- GET처럼 서버 상태를 변경하지 않는다.(안전한 메서드)
- curl -I 옵션을 쓰면 HEAD 메서드로 요청을 보낼 수 있다.
- 테스트 코드

```bash
curl -I https://example.com/image.png
```

#### OPTIONS

- 이 메서드는 대상 리소스의 통신 옵션(서버에서 지원하는 HTTP메서드 등)을 가져올 때 사용된다.(안전한 메서드)
- 테스트 코드

```bash
curl -X OPTIONS http://localhost:3000/resource -i
```

- -X {메서드} 옵션을 통해 특정 HTTP 메서드로 요청을 보낼 수 있다.
- -i 또는 --include 플래그는 curl 응답에 HTTP 헤더를 포함하도록 지시한다.

#### PUT

- 이 메서드는 리소스를 완전히 다른 버전으로 대체한다.
- 요청이 반복되면 동일한 리소스가 다시 대체되어 첫 번째 요청 후와 동일한 상태가 된다.

#### DELETE

- 리소스를 삭제하는 데 사용된다.
- 리소스가 삭제되면 삭제 작업을 반복해도 시스템 상태가 더 이상 변경되지 않는다.

### 멱등성을 가지지 않는 메서드

#### POST

- 새로운 리소스를 생성하는데 사용된다.
- 여러 POST 요청은 여러 리소스를 생성하는 결과를 초래하여 동일한 상태를 가지지 못하기 때문이다.

#### PATCH

- 리소스를 부분적으로 업데이트하는 데 사용된다.
- 멱등성 여부는 PATCH를 실행하는 방법에 따라 달라진다.
- 필드를 특정값으로 수정하는 것이라면 멱등성을 가진다.
- 특정 필드의 값을 증가시키거나 해당 배열에 요소를 추가시키는 것이라면 멱등성을 가지지 않는다.
- 멱등성을 가지지 않는 예시

```
PATCH /kundol-age
1) age : 30
2) age : 31
3) age : 32

PATCH /kundol-friends
1) friends : [종선]
2) friends : [종선, 종선]
3) friends : [종선, 종선, 종선]
```
